DROP TABLE IF EXISTS CONTAINS;
DROP TABLE IF EXISTS FLIGHT;
DROP TABLE IF EXISTS AIRLINE;
DROP TABLE IF EXISTS AIRPORT;

CREATE TABLE AIRPORT(
    AP_NAME VARCHAR(100) NOT NULL,
    ID VARCHAR(3) NOT NULL,
    STATE VARCHAR(15), 
    COUNTRY VARCHAR(30),
    CITY VARCHAR(15),
    PRIMARY KEY(ID)
);


INSERT INTO AIRPORT (AP_NAME, ID, STATE, COUNTRY, CITY) VALUES ('Anna International Airport', 'MAA', 'Tamilnadu', 'India', 'Chennai');
INSERT INTO AIRPORT (AP_NAME, ID, STATE, COUNTRY, CITY) VALUES ('John F Kennedy International Airport', 'JFK', 'New York State', 'USA', 'New York');
INSERT INTO AIRPORT (AP_NAME, ID, STATE, COUNTRY, CITY) VALUES ('John Lennon International Airport', 'LPL', 'Merseyside', 'UK', 'Liverpool');
INSERT INTO AIRPORT (AP_NAME, ID, STATE, COUNTRY, CITY) VALUES ('Heathrow', 'LHR', 'Greater London', 'UK', 'London');
INSERT INTO AIRPORT (AP_NAME, ID, STATE, COUNTRY, CITY) VALUES ('Los Angeles International Airport', 'LAX', 'California', 'USA', 'Los Angeles');
INSERT INTO AIRPORT (AP_NAME, ID, STATE, COUNTRY, CITY) VALUES ('Singapore Changi Airport', 'SIN', 'Singapore', 'Singapore', 'Singapore');
INSERT INTO AIRPORT (AP_NAME, ID, STATE, COUNTRY, CITY) VALUES ('Frankfurt International Airport', 'FRA', 'Hessen', 'Germany', 'Frankfurt');


CREATE TABLE AIRLINE(
    ID VARCHAR(3) NOT NULL, 
    AL_NAME VARCHAR(50),
    CODE VARCHAR(3) NOT NULL, 
    PRIMARY KEY(ID)
);

INSERT INTO AIRLINE (ID, AL_NAME, CODE) VALUES('AI','Air India Limited','098');
INSERT INTO AIRLINE (ID, AL_NAME, CODE) VALUES('LH','Lufthansa Airlines', '220');
INSERT INTO AIRLINE (ID, AL_NAME, CODE) VALUES('BA','British Airways','125');
INSERT INTO AIRLINE (ID, AL_NAME, CODE) VALUES('QR','Qatar Airways','157');
INSERT INTO AIRLINE (ID, AL_NAME, CODE) VALUES('AS','Air Asia','786');

CREATE TABLE FLIGHT (
    
    FLIGHT_CODE VARCHAR(10) NOT NULL,
    SOURCE VARCHAR(3),
    DESTINATION VARCHAR(3),
    START_TIME VARCHAR(10),
    END_TIME VARCHAR(10),
    STATUS VARCHAR(10),
    DURATION VARCHAR(30),
    FLIGHT_TYPE VARCHAR(10),
    AIRLINE_ID VARCHAR(3),
    
    CONSTRAINT CHK_Status CHECK(STATUS IN ('On-time', 'Delayed', 'Boarding')),
    CONSTRAINT CHK_Type CHECK(FLIGHT_TYPE IN ('Connecting', 'Non-stop')),    

    PRIMARY KEY(FLIGHT_CODE),
    FOREIGN KEY(AIRLINE_ID) REFERENCES AIRLINE(ID) ON DELETE CASCADE,
    FOREIGN KEY(SOURCE) REFERENCES AIRPORT(ID) ON DELETE CASCADE,
    FOREIGN KEY(DESTINATION) REFERENCES AIRPORT(ID) ON DELETE CASCADE
);


INSERT INTO FLIGHT(FLIGHT_CODE, SOURCE, DESTINATION, START_TIME, END_TIME, STATUS, DURATION, FLIGHT_TYPE, AIRLINE_ID)
VALUES('AI2014','MAA','JFK','02:10','23:15','On-time','23hr 5min','Non-stop','AI');
INSERT INTO FLIGHT(FLIGHT_CODE, SOURCE, DESTINATION, START_TIME, END_TIME, STATUS, DURATION, FLIGHT_TYPE, AIRLINE_ID)
VALUES('BA2345','MAA','LPL','07:10','16:45','On-time','9hr 35min','Non-stop','BA');
INSERT INTO FLIGHT(FLIGHT_CODE, SOURCE, DESTINATION, START_TIME, END_TIME, STATUS, DURATION, FLIGHT_TYPE, AIRLINE_ID)
VALUES('LH207','MAA','FRA','16:30','01:15','Delayed','8hr 45min','Connecting','LH');
INSERT INTO FLIGHT(FLIGHT_CODE, SOURCE, DESTINATION, START_TIME, END_TIME, STATUS, DURATION, FLIGHT_TYPE, AIRLINE_ID)
VALUES('AS3704','MAA','SIN','12:40','14:50','Boarding','2hr 10min','Connecting','AS');
INSERT INTO FLIGHT(FLIGHT_CODE, SOURCE, DESTINATION, START_TIME, END_TIME, STATUS, DURATION, FLIGHT_TYPE, AIRLINE_ID)
VALUES('AI2007','LPL','MAA','16:45','07:10','On-time','9hr 35min','Non-stop','AI');
INSERT INTO FLIGHT(FLIGHT_CODE, SOURCE, DESTINATION, START_TIME, END_TIME, STATUS, DURATION, FLIGHT_TYPE, AIRLINE_ID)
VALUES('QR2048','LAX','MAA','01:10','02:15','Delayed','25hr 5min','Non-stop','QR');
INSERT INTO FLIGHT(FLIGHT_CODE, SOURCE, DESTINATION, START_TIME, END_TIME, STATUS, DURATION, FLIGHT_TYPE, AIRLINE_ID)
VALUES('QR4014','SIN','MAA','18:10','20:10','Boarding','2hr','Non-stop','QR');
INSERT INTO FLIGHT(FLIGHT_CODE, SOURCE, DESTINATION, START_TIME, END_TIME, STATUS, DURATION, FLIGHT_TYPE, AIRLINE_ID)
VALUES('AI1014','LHR','MAA','02:10','23:15','On-time','23hr 5min','Connecting','AI');

CREATE TABLE CONTAINS(
    FLIGHT_CODE VARCHAR(10) NOT NULL,
    AIRPORT_ID VARCHAR(100) NOT NULL,
    PRIMARY KEY(FLIGHT_CODE, AIRPORT_ID),
    FOREIGN KEY(FLIGHT_CODE) REFERENCES FLIGHT(FLIGHT_CODE) ON DELETE CASCADE,
    FOREIGN KEY(AIRPORT_ID) REFERENCES AIRPORT(ID) ON DELETE CASCADE
);

INSERT INTO CONTAINS (FLIGHT_CODE, AIRPORT_ID) VALUES ('AI2014', 'MAA');
INSERT INTO CONTAINS (FLIGHT_CODE, AIRPORT_ID) VALUES ('BA2345', 'MAA');
INSERT INTO CONTAINS (FLIGHT_CODE, AIRPORT_ID) VALUES ('LH207', 'MAA');
INSERT INTO CONTAINS (FLIGHT_CODE, AIRPORT_ID) VALUES ('AS3704', 'MAA');
INSERT INTO CONTAINS (FLIGHT_CODE, AIRPORT_ID) VALUES ('AI2007', 'MAA');
INSERT INTO CONTAINS (FLIGHT_CODE, AIRPORT_ID) VALUES ('QR2048', 'MAA');
INSERT INTO CONTAINS (FLIGHT_CODE, AIRPORT_ID) VALUES ('QR4014', 'MAA');
INSERT INTO CONTAINS (FLIGHT_CODE, AIRPORT_ID) VALUES ('AI1014', 'MAA');

CREATE TABLE IF NOT EXISTS ACCOUNTS(
   ID int(11) NOT NULL AUTO_INCREMENT, 
   USERNAME varchar(50) NOT NULL,
   PASSWORD varchar(255) NOT NULL,
   PRIMARY KEY(ID)
);

ALTER TABLE ACCOUNTS AUTO_INCREMENT=3;
